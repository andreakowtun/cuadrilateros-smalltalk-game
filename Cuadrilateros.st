Object subclass: #Casilla	instanceVariableNames: 'ocupada jugador'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!Casilla methodsFor: 'initialization' stamp: 'fix 1'!initialize    super initialize.    ocupada := false.    jugador := nil! !!Casilla methodsFor: 'accessing' stamp: 'fix 1'!estaOcupada    ^ ocupada! !!Casilla methodsFor: 'accessing' stamp: 'fix 1'!obtenerJugador    ^ jugador! !!Casilla methodsFor: 'operations' stamp: 'fix 1'!ocupar: unJugador    ocupada := true.    jugador := unJugador! !!Casilla methodsFor: 'operations' stamp: 'fix 1'!liberar    ocupada := false.    jugador := nil! !Object subclass: #Cuadrilateros	instanceVariableNames: 'tablero jugadores turnoActual figuras finJuego'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!Cuadrilateros methodsFor: 'display' stamp: 'fix 1'!mostrarEstado    Transcript cr; show: '===== Estado del Juego ====='; cr.    jugadores do: [ :j |        Transcript show: j nombre, ' - Puntaje: ', j puntaje asString,                          ' - Figuras: ', j cantidadFiguras asString; cr    ]! !!Cuadrilateros methodsFor: 'initialization' stamp: 'fix 1'!inicializarConFilas: cantFilas columnas: cantColumnas jugadores: listaJugadores    tablero := Tablero filas: cantFilas columnas: cantColumnas.    jugadores := listaJugadores.    turnoActual := 1.    figuras := OrderedCollection new.    finJuego := false! !!Cuadrilateros methodsFor: 'accessing' stamp: 'fix 1'!jugadores    ^ jugadores! !!Cuadrilateros methodsFor: 'accessing' stamp: 'fix 1'!tablero    ^ tablero! !!Cuadrilateros methodsFor: 'accessing' stamp: 'fix 1'!jugadorActual    ^ jugadores at: turnoActual! !!Cuadrilateros methodsFor: 'game logic' stamp: 'andreakowtun 11/29/2025 21:44'!encontrarLugarParaAncho: ancho alto: alto    "Busca la primera posición donde entre la figura y la devuelve como Point (fila@columna)"    1 to: tablero filas do: [ :f |        1 to: tablero columnas do: [ :c |            (self puedeColocar: ancho alto: alto en: f columna: c)                 ifTrue: [ ^ f @ c ]         ]    ].    ^ nil "No entra"! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!colocarRectangulo: ancho alto: alto en: fila columna: columna    | jugador rectangulo |    jugador := self jugadorActual.    rectangulo := Rectangulo en: columna y: fila ancho: ancho alto: alto jugador: jugador.        fila to: (fila + alto - 1) do: [ :i |        columna to: (columna + ancho - 1) do: [ :j |            (tablero casillaEn: i columna: j) ocupar: jugador        ]    ].        figuras add: rectangulo.    jugador agregarFigura: rectangulo.    ^ rectangulo! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!tirarDados    | dado1 dado2 |    dado1 := (1 to: 6) atRandom.    dado2 := (1 to: 6) atRandom.    ^ Array with: dado1 with: dado2! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!pasarTurno    turnoActual := (turnoActual \\ jugadores size) + 1! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!puedeColocar: ancho alto: alto en: fila columna: columna    | filaFinal columnaFinal |    filaFinal := fila + alto - 1.    columnaFinal := columna + ancho - 1.        (filaFinal > tablero filas or: [ columnaFinal > tablero columnas ])         ifTrue: [ ^ false ].        fila to: filaFinal do: [ :i |        columna to: columnaFinal do: [ :j |            (tablero estaLibre: i columna: j) ifFalse: [ ^ false ]        ]    ].    ^ true! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!desempatar: ganadores    | maxFiguras |    maxFiguras := (ganadores collect: [ :j | j cantidadFiguras ]) max.    ^ ganadores detect: [ :j | j cantidadFiguras = maxFiguras ]! !!Cuadrilateros methodsFor: 'game logic' stamp: 'andreakowtun 11/19/2025 11:18'!calcularDimensiones: dados    | d1 d2 opciones |    d1 := dados first.    d2 := dados second.        opciones := OrderedCollection new.        "Opción 1: Tal cual salieron los dados (Ej: 3x4)"    opciones add: (Array with: d1 with: d2).        "Opción 2: Rotados (Ej: 4x3), solo si los dados son distintos"    d1 = d2 ifFalse: [         opciones add: (Array with: d2 with: d1)     ].        ^ opciones! !!Cuadrilateros methodsFor: 'game logic' stamp: 'fix 1'!ganador    | maxPuntaje ganadores |    maxPuntaje := (jugadores collect: [ :j | j puntaje ]) max.    ganadores := jugadores select: [ :j | j puntaje = maxPuntaje ].        ganadores size = 1         ifTrue: [ ^ ganadores first ]        ifFalse: [ ^ self desempatar: ganadores ]! !!Cuadrilateros methodsFor: 'game logic' stamp: 'andreakowtun 11/19/2025 12:34'!cabeEnAlgunaParte: ancho alto: alto    "Recorremos todo el tablero para ver si la figura entra en algun lado"    1 to: tablero filas do: [ :f |        1 to: tablero columnas do: [ :c |            (self puedeColocar: ancho alto: alto en: f columna: c)                 ifTrue: [ ^ true ] "se encontro un lugar"        ]    ].    ^ false "Recorrimos todo y no entra en ningún lado"! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Cuadrilateros class	instanceVariableNames: ''!!Cuadrilateros class methodsFor: 'instance creation' stamp: 'fix 1'!nuevoJuegoFilas: filas columnas: columnas jugadores: listaJugadores    ^ self new inicializarConFilas: filas columnas: columnas jugadores: listaJugadores! !!Cuadrilateros class methodsFor: 'running' stamp: 'andreakowtun 11/30/2025 04:08'!ejecutar    | modo nombreHu nombreHu2 jugador1 jugador2 juego ventana |    "modo de juego?"    modo := UIManager default         chooseFrom: #('1 Jugador (Vs CPU)' '2 Jugadores')         title: 'Selecciona el modo de juego'.    modo = 0 ifTrue: [ ^ self ].     "Configurar Jugador 1"    nombreHu := UIManager default request: 'Nombre del Jugador 1'.    (nombreHu isNil or: [nombreHu isEmpty]) ifTrue: [ nombreHu := 'Jugador 1' ].    jugador1 := Jugador nombre: nombreHu.    jugador1 color: (Color blue alpha: 0.6).    "Configurar Oponente"    modo = 1         ifTrue: [             jugador2 := CPUJugador nombre: 'Compu :)'.            jugador2 color: (Color red alpha: 0.6).        ]        ifFalse: [             nombreHu2 := UIManager default request: 'Nombre del Jugador 2'.            (nombreHu2 isNil or: [nombreHu2 isEmpty]) ifTrue: [ nombreHu2 := 'Jugador 2' ].            jugador2 := Jugador nombre: nombreHu2.            jugador2 color: (Color red alpha: 0.6).        ].    juego := self nuevoJuegoFilas: 15 columnas: 15         jugadores: { jugador1 . jugador2 }.    ventana := VentanaJuego juego: juego.    ventana openInWorld.! !Object subclass: #Jugador	instanceVariableNames: 'nombre puntaje figurasCreadas color'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!Jugador methodsFor: 'operations' stamp: 'fix 1'!agregarFigura: unaFigura    figurasCreadas add: unaFigura.    puntaje := puntaje + unaFigura area! !!Jugador methodsFor: 'accessing' stamp: 'fix 1'!puntaje    ^ puntaje! !!Jugador methodsFor: 'accessing' stamp: 'fix 1'!nombre    ^ nombre! !!Jugador methodsFor: 'accessing' stamp: 'andreakowtun 11/19/2025 02:43'!color    ^ color! !!Jugador methodsFor: 'accessing' stamp: 'andreakowtun 11/19/2025 02:43'!color: unColor    color := unColor! !!Jugador methodsFor: 'accessing' stamp: 'fix 1'!cantidadFiguras    ^ figurasCreadas size! !!Jugador methodsFor: 'initialization' stamp: 'fix 1'!inicializarConNombre: unNombre    nombre := unNombre.    puntaje := 0.    figurasCreadas := OrderedCollection new! !!Jugador methodsFor: 'testing' stamp: 'andreakowtun 11/29/2025 21:43'!esHumano    ^ true! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Jugador class	instanceVariableNames: ''!!Jugador class methodsFor: 'instance creation' stamp: 'fix 1'!nombre: unNombre    ^ self new inicializarConNombre: unNombre! !Jugador subclass: #CPUJugador	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!CPUJugador methodsFor: 'testing' stamp: 'andreakowtun 11/29/2025 21:44'!esHumano    ^ false! !Object subclass: #Rectangulo	instanceVariableNames: 'x y ancho alto jugador'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!Rectangulo methodsFor: 'testing' stamp: 'fix 1'!esCuadrado    ^ ancho = alto! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!y    ^ y! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!alto    ^ alto! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!ancho    ^ ancho! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!area    ^ ancho * alto! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!x    ^ x! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!perimetro    ^ 2 * (ancho + alto)! !!Rectangulo methodsFor: 'accessing' stamp: 'fix 1'!obtenerJugador    ^ jugador! !!Rectangulo methodsFor: 'initialization' stamp: 'fix 1'!inicializarEn: posX y: posY ancho: anchoRect alto: altoRect jugador: unJugador    x := posX.    y := posY.    ancho := anchoRect.    alto := altoRect.    jugador := unJugador! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Rectangulo class	instanceVariableNames: ''!!Rectangulo class methodsFor: 'instance creation' stamp: 'fix 1'!en: posX y: posY ancho: anchoRect alto: altoRect jugador: unJugador    ^ self new inicializarEn: posX y: posY ancho: anchoRect alto: altoRect jugador: unJugador! !Object subclass: #Tablero	instanceVariableNames: 'filas columnas grilla'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!Tablero methodsFor: 'testing' stamp: 'fix 1'!estaLibre: fila columna: columna    ^ (self casillaEn: fila columna: columna) estaOcupada not! !!Tablero methodsFor: 'accessing' stamp: 'fix 1'!filas    ^ filas! !!Tablero methodsFor: 'accessing' stamp: 'fix 1'!casillaEn: fila columna: columna    ^ grilla at: fila at: columna! !!Tablero methodsFor: 'accessing' stamp: 'fix 1'!columnas    ^ columnas! !!Tablero methodsFor: 'private' stamp: 'fix 1'!crearGrilla    grilla := Array2D rows: filas columns: columnas.    1 to: filas do: [ :i |        1 to: columnas do: [ :j |            grilla at: i at: j put: Casilla new        ]    ]! !!Tablero methodsFor: 'initialization' stamp: 'fix 1'!inicializarConFilas: cantFilas columnas: cantColumnas    filas := cantFilas.    columnas := cantColumnas.    self crearGrilla! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Tablero class	instanceVariableNames: ''!!Tablero class methodsFor: 'instance creation' stamp: 'fix 1'!filas: cantFilas columnas: cantColumnas    ^ self new inicializarConFilas: cantFilas columnas: cantColumnas! !BorderedMorph subclass: #TableroMorph	instanceVariableNames: 'tablero tamanioCelda colores dimensionActual callbackColocar juego'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!TableroMorph methodsFor: 'drawing' stamp: 'fix 1'!actualizar    self dibujarTablero! !!TableroMorph methodsFor: 'drawing' stamp: 'fix 1'!dibujarTablero    self removeAllMorphs.    1 to: tablero filas do: [ :fila |        1 to: tablero columnas do: [ :columna |            self dibujarCasilla: fila columna: columna        ]    ]! !!TableroMorph methodsFor: 'drawing' stamp: 'fix 1'!dibujarCasilla: fila columna: columna    | casilla colorCelda celdaMorph |    casilla := tablero casillaEn: fila columna: columna.    colorCelda := self colorParaCasilla: casilla.        celdaMorph := BorderedMorph new        extent: tamanioCelda @ tamanioCelda;        position: ((columna - 1) * tamanioCelda) @ ((fila - 1) * tamanioCelda);        color: colorCelda;        borderWidth: 1;        borderColor: Color gray.        self addMorph: celdaMorph! !!TableroMorph methodsFor: 'drawing' stamp: 'andreakowtun 11/19/2025 02:48'!colorParaCasilla: casilla    casilla estaOcupada ifFalse: [ ^ Color white ].    ^ casilla obtenerJugador color ! !!TableroMorph methodsFor: 'drawing' stamp: 'andreakowtun 11/29/2025 23:35'!configurarMorph    self         borderWidth: 2;        borderColor: Color black;        color: Color transparent ;        extent: (tablero columnas * tamanioCelda) @ (tablero filas * tamanioCelda)! !!TableroMorph methodsFor: 'initialization' stamp: 'fix 1'!inicializarConTablero: unTablero    super initialize.    tablero := unTablero.    tamanioCelda := 30.    juego := nil.    dimensionActual := nil.    callbackColocar := nil.    self inicializarColores.    self configurarMorph.    self dibujarTablero! !!TableroMorph methodsFor: 'initialization' stamp: 'fix 1'!inicializarColores    colores := Dictionary new.    colores at: nil put: Color white! !!TableroMorph methodsFor: 'accessing' stamp: 'fix 1'!juego: unJuego    juego := unJuego! !!TableroMorph methodsFor: 'accessing' stamp: 'andreakowtun 11/29/2025 23:11'!tamanioCelda: unNumero    tamanioCelda := unNumero.    self extent: (tablero columnas * tamanioCelda) @ (tablero filas * tamanioCelda).    self dibujarTablero.! !!TableroMorph methodsFor: 'preview' stamp: 'andreakowtun 11/29/2025 23:34'!dibujarPreview: evt    | pos fila columna ancho alto |    self removePreview.        pos := evt position - self position.    columna := (pos x // tamanioCelda) max: 1.    fila := (pos y // tamanioCelda) max: 1.    ancho := dimensionActual first.    alto := dimensionActual second.        (fila + alto - 1 <= tablero filas and: [ columna + ancho - 1 <= tablero columnas ])         ifTrue: [            self crearPreview: fila columna: columna ancho: ancho alto: alto        ]! !!TableroMorph methodsFor: 'preview' stamp: 'andreakowtun 11/29/2025 23:34'!crearPreview: fila columna: col ancho: ancho alto: alto    | preview posX posY anchoTotal altoTotal puedeColocar colorPreview |        puedeColocar := juego puedeColocar: ancho alto: alto en: fila columna: col.    colorPreview := puedeColocar         ifTrue: [ Color green alpha: 0.3 ]        ifFalse: [ Color red alpha: 0.3 ].            posX := (col - 1) * tamanioCelda.    posY := (fila - 1) * tamanioCelda.    anchoTotal := ancho * tamanioCelda.    altoTotal := alto * tamanioCelda.        preview := BorderedMorph new        position: posX @ posY;        extent: anchoTotal @ altoTotal;        color: colorPreview;        borderWidth: 3;        borderColor: Color black;        lock;         yourself.            self addMorphFront: preview.    self setProperty: #previewMorph toValue: preview! !!TableroMorph methodsFor: 'preview' stamp: 'andreakowtun 11/29/2025 23:34'!removePreview    | preview |    preview := self valueOfProperty: #previewMorph.    preview ifNotNil: [         preview delete.        self removeProperty: #previewMorph    ]! !!TableroMorph methodsFor: 'placement' stamp: 'andreakowtun 11/29/2025 22:56'!pintarJugador: jugador enFila: fila columna: col ancho: ancho alto: alto    | colorJugador centroX centroY etiqueta |    colorJugador := jugador color.        "Pintamos las celdas"    fila to: (fila + alto - 1) do: [ :i |        col to: (col + ancho - 1) do: [ :j |            (i <= tablero filas and: [ j <= tablero columnas ]) ifTrue: [                | posX posY |                posX := self position x + ((j - 1) * tamanioCelda).                posY := self position y + ((i - 1) * tamanioCelda).                                self submorphs do: [ :morph |                    morph position = (posX @ posY) ifTrue: [                        morph color: colorJugador                    ]                ]            ]        ]    ].    "Dibujamos el número del área en el centro"    centroX := self position x + ((col - 1) * tamanioCelda) + ((ancho * tamanioCelda) / 2).    centroY := self position y + ((fila - 1) * tamanioCelda) + ((alto * tamanioCelda) / 2).        etiqueta := StringMorph contents: (ancho * alto) asString.    etiqueta font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 12). "Tamanio fuente"    etiqueta color: Color black.        self addMorphFront: etiqueta.    etiqueta center: (centroX @ centroY).! !!TableroMorph methodsFor: 'placement' stamp: 'fix 1'!activarColocacion: ancho alto: alto callback: unBloque    dimensionActual := Array with: ancho with: alto.    callbackColocar := unBloque! !!TableroMorph methodsFor: 'placement' stamp: 'fix 1'!desactivarColocacion    self removePreview.    dimensionActual := nil.    callbackColocar := nil! !!TableroMorph methodsFor: 'event handling' stamp: 'fix 1'!mouseDown: evt    dimensionActual ifNotNil: [        | pos fila columna ancho alto |        pos := evt position - self position.        columna := (pos x // tamanioCelda) + 1.        fila := (pos y // tamanioCelda) + 1.        ancho := dimensionActual first.        alto := dimensionActual second.                callbackColocar ifNotNil: [            callbackColocar value: fila value: columna value: ancho value: alto        ]    ]! !!TableroMorph methodsFor: 'event handling' stamp: 'fix 1'!handlesMouseDown: evt    ^ true! !!TableroMorph methodsFor: 'event handling' stamp: 'fix 1'!handlesMouseStillDown: evt    ^ true! !!TableroMorph methodsFor: 'event handling' stamp: 'fix 1'!mouseLeave: evt    self removePreview! !!TableroMorph methodsFor: 'event handling' stamp: 'andreakowtun 11/29/2025 23:21'!mouseMove: evt    "Desactivado completamente"! !!TableroMorph methodsFor: 'event handling' stamp: 'fix 1'!mouseEnter: evt    dimensionActual ifNotNil: [        self dibujarPreview: evt    ]! !!TableroMorph methodsFor: 'event handling' stamp: 'andreakowtun 11/29/2025 23:21'!handlesMouseOver: evt    ^ false! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!TableroMorph class	instanceVariableNames: ''!!TableroMorph class methodsFor: 'instance creation' stamp: 'fix 1'!tablero: unTablero    ^ self new inicializarConTablero: unTablero! !SystemWindow subclass: #VentanaJuego	instanceVariableNames: 'juego tableroVisual panelInfo botonTirar'	classVariableNames: ''	poolDictionaries: ''	category: 'Cuadrilateros'!!VentanaJuego methodsFor: 'updating' stamp: 'andreakowtun 11/19/2025 12:40'!actualizarInterfaz    self actualizarInfo! !!VentanaJuego methodsFor: 'updating' stamp: 'andreakowtun 11/29/2025 23:39'!actualizarInfo    | filaHeader filaJugador muestraColor fontGrande fontMedia escala|	escala := (Display height / 800.0) max: 1.0.        fontGrande := LogicalFont familyName: 'Source Sans Pro' pointSize: (20 * escala).    fontMedia := LogicalFont familyName: 'Source Sans Pro' pointSize: (16 * escala).        panelInfo removeAllMorphs.    panelInfo listDirection: #topToBottom.        "ENCABEZADOS"    filaHeader := self crearFila.    filaHeader addMorphBack: (self crearCelda: 'NOMBRE' ancho: 80 font: fontGrande color: Color white).    filaHeader addMorphBack: (self crearCelda: 'COLOR' ancho: 50 font: fontGrande color: Color white).    filaHeader addMorphBack: (self crearCelda: 'PTS' ancho: 40 font: fontGrande color: Color white).    filaHeader addMorphBack: (self crearCelda: 'FIGS' ancho: 40 font: fontGrande color: Color white).    panelInfo addMorphBack: filaHeader.        panelInfo addMorphBack: (Morph new color: Color white; height: 2; hResizing: #spaceFill).    "JUGADORES"    juego jugadores do: [ :j |        filaJugador := self crearFila.        filaJugador addMorphBack: (self crearCelda: j nombre ancho: 80 font: fontMedia color: Color white).                muestraColor := BorderedMorph new color: j color; borderColor: Color white; borderWidth: 1; extent: 20@20.        filaJugador addMorphBack: (Morph new color: Color transparent; width: 50; addMorphCentered: muestraColor).                filaJugador addMorphBack: (self crearCelda: j puntaje ancho: 40 font: fontMedia color: Color white).        filaJugador addMorphBack: (self crearCelda: j cantidadFiguras ancho: 40 font: fontMedia color: Color white).                panelInfo addMorphBack: filaJugador.    ].    "TURNO"    panelInfo addMorphBack: (Morph new color: Color transparent; height: 30).    panelInfo addMorphBack: ((StringMorph contents: 'Turno de: ', juego jugadorActual nombre)                                 font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 22);                                color: Color yellow).                                    botonTirar ifNotNil: [        juego jugadorActual esHumano             ifTrue: [ botonTirar show ]            ifFalse: [ botonTirar hide ].    ].    (juego jugadorActual esHumano) ifFalse: [ self ejecutarTurnoCPU ].! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/20/2025 09:26'!intentarColocar: fila columna: columna ancho: ancho alto: alto    (juego puedeColocar: ancho alto: alto en: fila columna: columna)        ifTrue: [            juego colocarRectangulo: ancho alto: alto en: fila columna: columna.                        tableroVisual pintarJugador: juego jugadorActual                          enFila: fila columna: columna ancho: ancho alto: alto.                        tableroVisual desactivarColocacion.                        "Si es cuadrado, repite turno"            ancho = alto                 ifTrue: [                     self mostrarCartelTitulo: '¡DOBLES!!'                         mensaje: 'Formaste un cuadrado. ¡Tiras de nuevo!!'                         color: Color green darker.                                    ]                ifFalse: [                     juego pasarTurno.                    " no mostramos cartel para no cortar el ritmo del juego, solo actualizamos"                ].                        "Actualizamos la tabla de puntajes a la derecha"            self actualizarInterfaz.        ]        ifFalse: [                        self mostrarCartelTitulo: '¡ERROR!!'                 mensaje: 'No cabe ahí. Prueba otra posición.'                 color: Color red.        ]! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/29/2025 22:58'!accionTirarDados    | dados dimensiones opcionesValidas eleccionIndex dim ancho alto texto nuevoValor otroDado |        dados := juego tirarDados.        "COMODIN"    (dados includes: 1) ifTrue: [        "Averiguamos cual es el otro valor que salio junto con el 1"        otroDado := dados detect: [ :d | d ~= 1 ] ifNone: [ 1 ].                "Mostramos el otro valor en el titulo para que el usuario sepa que le conviene"        nuevoValor := UIManager default             chooseFrom: #('1' '2' '3' '4' '5' '6')            title: ('¡SACASTE 1 y ', otroDado asString, '!! Elige el valor para reemplazar el 1:').                    "Aplicamos el cambio"        nuevoValor > 0 ifTrue: [            dados at: (dados indexOf: 1) put: (nuevoValor).            UIManager default inform: 'Jugada final: ', nuevoValor asString, ' y ', otroDado asString.        ]    ].    "---------------------------------------------"    dimensiones := juego calcularDimensiones: dados.        opcionesValidas := dimensiones select: [ :d |         juego cabeEnAlgunaParte: d first alto: d second     ].        opcionesValidas ifEmpty: [        self mostrarAvisoBloqueo: dados.        ^ self    ].        texto := dimensiones size > 1         ifTrue: [ 'Elige tu figura (Dados: ', dados first asString, ' y ', dados second asString, ')' ]        ifFalse: [ 'Figura obligada' ].    eleccionIndex := UIManager default         chooseFrom: (opcionesValidas collect: [:d | d first asString, ' x ', d second asString])        title: texto.            eleccionIndex = 0 ifTrue: [ ^ self ].    dim := opcionesValidas at: eleccionIndex.        ancho := dim first.    alto := dim second.        self activarModoColocacion: ancho alto: alto! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/20/2025 09:39'!finalizarPartida    | ganador overlay caja titulo texto |    ganador := juego ganador.        overlay := Morph new color: (Color black alpha: 0.6); extent: self extent; position: self position.        caja := BorderedMorph new color: Color white; borderColor: Color purple; borderWidth: 4; extent: 300@150.    caja cornerStyle: #rounded.        titulo := StringMorph contents: '¡FIN DEL JUEGO!!'.    titulo color: Color purple.        titulo font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 20).        texto := StringMorph contents: ('Ganador: ', ganador nombre, String cr, 'Puntos: ', ganador puntaje asString).    texto color: Color black.        overlay addMorph: caja.    caja center: overlay center.    caja addMorph: titulo.    titulo center: (caja center x) @ (caja top + 30).    caja addMorph: texto.    texto center: (caja center x) @ (caja center y + 10).        overlay on: #mouseDown send: #delete to: self.        self addMorphFront: overlay! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/19/2025 02:22'!activarModoColocacion: ancho alto: alto    tableroVisual activarColocacion: ancho alto: alto callback: [ :fila :columna :w :h |        self intentarColocar: fila columna: columna ancho: w alto: h    ]! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/29/2025 23:03'!ejecutarTurnoCPU    "Logica de Inteligencia Artificial simple"        [        | dados dimensiones opcionesValidas mejorOpcion ancho alto pos |                "Esperamos un poco para que parezca que 'piensa' y no sea instantáneo"        (Delay forSeconds: 1) wait.                "Tiramos dados"        dados := juego tirarDados.                "Regla del Comodín: Si sale 1, la CPU siempre elige 6"        (dados includes: 1) ifTrue: [             dados at: (dados indexOf: 1) put: 6.        ].                dimensiones := juego calcularDimensiones: dados.                "Busca opciones que entren"        opcionesValidas := dimensiones select: [ :d |             (juego encontrarLugarParaAncho: d first alto: d second) notNil         ].                opcionesValidas ifEmpty: [            self mostrarAvisoBloqueo: dados.        ] ifNotEmpty: [            "Elege la primera opción válida"            mejorOpcion := opcionesValidas first.            ancho := mejorOpcion first.            alto := mejorOpcion second.                        "Busca coordenada exacta"            pos := juego encontrarLugarParaAncho: ancho alto: alto.                        self intentarColocar: pos x columna: pos y ancho: ancho alto: alto.        ].            ] fork. "Ejecutamos en segundo plano para no congelar la ventana"! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/20/2025 09:38'!mostrarAvisoBloqueo: dados    | overlay caja titulo texto |        overlay := Morph new color: (Color black alpha: 0.6); extent: self extent; position: self position.        caja := BorderedMorph new color: Color white; borderColor: Color red; borderWidth: 4; extent: 300@150.    caja cornerStyle: #rounded.        titulo := StringMorph contents: '¡SIN ESPACIO!!'.    titulo color: Color red.	titulo font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 20).        texto := StringMorph contents: ('Sacaste ', dados first asString, ' y ', dados second asString, '.', String cr, 'No entran en el tablero.').    texto color: Color black.        overlay addMorph: caja.    caja center: overlay center.    caja addMorph: titulo.    titulo center: (caja center x) @ (caja top + 30).    caja addMorph: texto.    texto center: (caja center x) @ (caja center y + 10).        overlay on: #mouseDown send: #value to: [         overlay delete.         self finalizarPartida     ].        self addMorphFront: overlay! !!VentanaJuego methodsFor: 'actions' stamp: 'andreakowtun 11/29/2025 23:03'!mostrarCartelTitulo: unTitulo mensaje: unMensaje color: unColor    | overlay caja titulo texto |    overlay := Morph new color: (Color black alpha: 0.6); extent: self extent; position: self position.    caja := BorderedMorph new color: Color white; borderColor: unColor; borderWidth: 4; extent: 300@150.    caja cornerStyle: #rounded.    titulo := StringMorph contents: unTitulo.    titulo color: unColor.     titulo font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 20).    texto := StringMorph contents: unMensaje.    texto color: Color black.    overlay addMorph: caja.    caja center: overlay center.    caja addMorph: titulo.    titulo center: (caja center x) @ (caja top + 30).    caja addMorph: texto.    texto center: (caja center x) @ (caja center y + 10).    overlay on: #mouseDown send: #delete to: overlay.    self addMorphFront: overlay! !!VentanaJuego methodsFor: 'initialization' stamp: 'andreakowtun 11/29/2025 23:53'!openInWorld     super openInWorld.        "Ponemos en 50@50 para esquivar la barra de menú de arriba"    self position: 50@50.        "Ajustamos el tamaño para que no se salga de la pantalla"    self extent: (World extent - (100@100)).        self comeToFront.! !!VentanaJuego methodsFor: 'initialization' stamp: 'fix 1'!initialize    super initialize.    tableroVisual := nil.    panelInfo := nil.    botonTirar := nil! !!VentanaJuego methodsFor: 'initialization' stamp: 'andreakowtun 11/29/2025 23:51'!inicializarConJuego: unJuego    | altoDisponible nuevaCelda |    juego := unJuego.        self construirVentana.        "Cálculo del tamaño de celdas basado en la pantalla"    altoDisponible := World bounds height.    nuevaCelda := (altoDisponible - 120) // juego tablero filas.        "Aplicamos el tamaño al tablero"    tableroVisual tamanioCelda: nuevaCelda.        "Color de fondo"    self color: (Color r: 0.1 g: 0.1 b: 0.25).! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/29/2025 23:39'!construirBotones    | panelBotones |    panelBotones := Morph new        color: Color transparent;        layoutPolicy: TableLayout new;        listDirection: #topToBottom;        hResizing: #spaceFill;        vResizing: #spaceFill;        cellInset: 20;         layoutInset: 20.    botonTirar := SimpleButtonMorph new.    botonTirar label: 'TIRAR DADOS'.    botonTirar color: (Color r: 0.0 g: 0.7 b: 0.0). "Verde más intenso"    botonTirar borderWidth: 3; borderColor: Color white.    botonTirar target: self; actionSelector: #accionTirarDados.        "Tamanio boton"    botonTirar extent: 250@100.        botonTirar hResizing: #rigid.    botonTirar vResizing: #rigid.    "Agrandamos la letra buscando el texto adentro"    botonTirar submorphs do: [ :m |         (m isKindOf: StringMorph) ifTrue: [             m font: (LogicalFont familyName: 'Source Sans Pro' pointSize: 30).            m color: Color white.        ]     ].    panelBotones addMorph: botonTirar.        "Centramos el botón en el panel"    panelBotones wrapCentering: #center.        self addMorph: panelBotones frame: (0.75@0.7 corner: 1@1)! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/19/2025 02:53'!crearCelda: texto ancho: unAncho    | contenedor etiqueta |    contenedor := Morph new        color: Color transparent;        hResizing: #rigid; "Ancho fijo"        vResizing: #spaceFill;        width: unAncho.            etiqueta := StringMorph contents: texto asString.    contenedor addMorph: etiqueta.    etiqueta center: contenedor center. "Centrar texto"        ^ contenedor! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/19/2025 02:52'!crearFila    ^ Morph new        color: Color transparent;        layoutPolicy: TableLayout new;        listDirection: #leftToRight;        hResizing: #spaceFill;        vResizing: #rigid;        height: 24;        cellInset: 5 "Espacio entre columnas"! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/19/2025 01:51'!construirTablero    tableroVisual := TableroMorph tablero: juego tablero.    tableroVisual juego: juego.    self addMorph: tableroVisual frame: (0@0 corner: 0.6@1)! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/19/2025 01:51'!construirPanelInfo    panelInfo := Morph new        color: Color lightGray;        layoutPolicy: TableLayout new;        hResizing: #spaceFill;        vResizing: #spaceFill.    self addMorph: panelInfo frame: (0.6@0 corner: 1@0.7).    self actualizarInfo! !!VentanaJuego methodsFor: 'building' stamp: 'fix 1'!construirVentana    self setLabel: 'Juego Cuadrilateros'.    self construirTablero.    self construirPanelInfo.    self construirBotones! !!VentanaJuego methodsFor: 'building' stamp: 'andreakowtun 11/29/2025 23:00'!crearCelda: texto ancho: unAncho font: unaFuente color: unColor    | contenedor etiqueta |        "Creamos la caja contenedora transparente"    contenedor := Morph new         color: Color transparent;         hResizing: #rigid;         vResizing: #spaceFill;         width: unAncho.        "Creamos el texto y le aplicamos el estilo aqui"    etiqueta := StringMorph contents: texto asString.    etiqueta font: unaFuente.    etiqueta color: unColor.        "Metemos el texto en la caja y centramos"    contenedor addMorph: etiqueta.    etiqueta center: contenedor center.        ^ contenedor! !!VentanaJuego methodsFor: 'display' stamp: 'andreakowtun 11/29/2025 23:01'!efectoVisual    | colorOriginal |    colorOriginal := panelInfo color.        panelInfo color: (Color white alpha: 0.8).        self world ifNotNil: [ :w | w doOneCycle ].    (Delay forMilliseconds: 100) wait.        panelInfo color: colorOriginal.    self world ifNotNil: [ :w | w doOneCycle ].! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!VentanaJuego class	instanceVariableNames: ''!!VentanaJuego class methodsFor: 'accessing' stamp: 'andreakowtun 11/19/2025 01:36'!juego: unJuego    ^ self new inicializarConJuego: unJuego! !